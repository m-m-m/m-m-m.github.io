<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_91) on Sat Aug 06 16:02:16 CEST 2016 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>CsrfTokenManagerDefaultImpl (JavaDocs for mmm-all dev-SNAPSHOT)</title>
<meta name="date" content="2016-08-06">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CsrfTokenManagerDefaultImpl (JavaDocs for mmm-all dev-SNAPSHOT)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CsrfTokenManagerDefaultImpl.html">Use</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../../net/sf/mmm/service/impl/server/RemoteInvocationSecurityDetectorImpl.html" title="class in net.sf.mmm.service.impl.server"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?net/sf/mmm/service/impl/server/CsrfTokenManagerDefaultImpl.html" target="_top">Frames</a></li>
<li><a href="CsrfTokenManagerDefaultImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">net.sf.mmm.service.impl.server</div>
<h2 title="Class CsrfTokenManagerDefaultImpl" class="title">Class CsrfTokenManagerDefaultImpl</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../../net/sf/mmm/util/component/base/AbstractComponent.html" title="class in net.sf.mmm.util.component.base">net.sf.mmm.util.component.base.AbstractComponent</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../../net/sf/mmm/util/component/base/AbstractLoggableComponent.html" title="class in net.sf.mmm.util.component.base">net.sf.mmm.util.component.base.AbstractLoggableComponent</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../../net/sf/mmm/service/base/server/AbstractCsrfTokenManager.html" title="class in net.sf.mmm.service.base.server">net.sf.mmm.service.base.server.AbstractCsrfTokenManager</a></li>
<li>
<ul class="inheritance">
<li>net.sf.mmm.service.impl.server.CsrfTokenManagerDefaultImpl</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../../net/sf/mmm/service/base/server/CsrfTokenManager.html" title="interface in net.sf.mmm.service.base.server">CsrfTokenManager</a>, <a href="../../../../../../net/sf/mmm/util/lang/api/concern/Security.html" title="interface in net.sf.mmm.util.lang.api.concern">Security</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">CsrfTokenManagerDefaultImpl</span>
extends <a href="../../../../../../net/sf/mmm/service/base/server/AbstractCsrfTokenManager.html" title="class in net.sf.mmm.service.base.server">AbstractCsrfTokenManager</a></pre>
<div class="block">This is the default implementation of <a href="../../../../../../net/sf/mmm/service/base/server/CsrfTokenManager.html" title="interface in net.sf.mmm.service.base.server"><code>CsrfTokenManager</code></a>. It generates a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util"><code>UUID</code></a></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0.0</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Joerg Hohwiller (hohwille at users.sourceforge.net)</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../net/sf/mmm/service/impl/server/CsrfTokenManagerDefaultImpl.html#CsrfTokenManagerDefaultImpl--">CsrfTokenManagerDefaultImpl</a></span>()</code>
<div class="block">The constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api">CsrfToken</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../net/sf/mmm/service/impl/server/CsrfTokenManagerDefaultImpl.html#generateInitialToken--">generateInitialToken</a></span>()</code>
<div class="block">This method generates a new <a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api"><code>CsrfToken</code></a> for the initial "log-in" of a user.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api">CsrfToken</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../net/sf/mmm/service/impl/server/CsrfTokenManagerDefaultImpl.html#generateNewToken--">generateNewToken</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>protected javax.servlet.http.HttpSession</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../net/sf/mmm/service/impl/server/CsrfTokenManagerDefaultImpl.html#getSession--">getSession</a></span>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.net.sf.mmm.service.base.server.AbstractCsrfTokenManager">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;net.sf.mmm.service.base.server.<a href="../../../../../../net/sf/mmm/service/base/server/AbstractCsrfTokenManager.html" title="class in net.sf.mmm.service.base.server">AbstractCsrfTokenManager</a></h3>
<code><a href="../../../../../../net/sf/mmm/service/base/server/AbstractCsrfTokenManager.html#generateUpdateToken-net.sf.mmm.service.api.CsrfToken-">generateUpdateToken</a>, <a href="../../../../../../net/sf/mmm/service/base/server/AbstractCsrfTokenManager.html#isValidToken-net.sf.mmm.service.api.CsrfToken-">isValidToken</a>, <a href="../../../../../../net/sf/mmm/service/base/server/AbstractCsrfTokenManager.html#validateToken-net.sf.mmm.service.api.CsrfToken-">validateToken</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.net.sf.mmm.util.component.base.AbstractLoggableComponent">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;net.sf.mmm.util.component.base.<a href="../../../../../../net/sf/mmm/util/component/base/AbstractLoggableComponent.html" title="class in net.sf.mmm.util.component.base">AbstractLoggableComponent</a></h3>
<code><a href="../../../../../../net/sf/mmm/util/component/base/AbstractLoggableComponent.html#createLogger--">createLogger</a>, <a href="../../../../../../net/sf/mmm/util/component/base/AbstractLoggableComponent.html#doInitialize--">doInitialize</a>, <a href="../../../../../../net/sf/mmm/util/component/base/AbstractLoggableComponent.html#getLogger--">getLogger</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.net.sf.mmm.util.component.base.AbstractComponent">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;net.sf.mmm.util.component.base.<a href="../../../../../../net/sf/mmm/util/component/base/AbstractComponent.html" title="class in net.sf.mmm.util.component.base">AbstractComponent</a></h3>
<code><a href="../../../../../../net/sf/mmm/util/component/base/AbstractComponent.html#doInitialized--">doInitialized</a>, <a href="../../../../../../net/sf/mmm/util/component/base/AbstractComponent.html#getInitializationState--">getInitializationState</a>, <a href="../../../../../../net/sf/mmm/util/component/base/AbstractComponent.html#initialize--">initialize</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="CsrfTokenManagerDefaultImpl--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CsrfTokenManagerDefaultImpl</h4>
<pre>public&nbsp;CsrfTokenManagerDefaultImpl()</pre>
<div class="block">The constructor.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="generateInitialToken--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateInitialToken</h4>
<pre>public&nbsp;<a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api">CsrfToken</a>&nbsp;generateInitialToken()</pre>
<div class="block">This method generates a new <a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api"><code>CsrfToken</code></a> for the initial "log-in" of a user. Here are some examples
 of possible implementation strategies:
 <ul>
 <li>A token is generated that simply contains the session ID. If an attacker can force the browser to
 send a request to your service and after the user has already logged into your application the browser
 will send authentication data for the request (CSRF). However, the attacker can not easily access your
 session ID due to the SOP (Same Origin Policy).</li>
 <li>A token is generated with a unique ID that the client can not guess such as a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/UUID.html?is-external=true" title="class or interface in java.util"><code>UUID</code></a>.
 The token is also stored in the server-side HTTP session so it can be compared for
 <a href="../../../../../../net/sf/mmm/service/base/server/CsrfTokenManager.html#isValidToken-net.sf.mmm.service.api.CsrfToken-"><code>validation</code></a>.</li>
 <li>A token is generated from a combination of different aspects (e.g. user login, user agent,
 server-secret, etc.) and digitally signed an encrypted. This approach can also be used in situations
 where no server-side HTTP session exists (e.g. with only HTTP Basic Authentication) as the
 <a href="../../../../../../net/sf/mmm/service/base/server/CsrfTokenManager.html#isValidToken-net.sf.mmm.service.api.CsrfToken-"><code>validation</code></a> can decrypt the token, split the aspects and verify them.
 </li>
 </ul>
 In case you create your own implementation be aware of the following things:
 <ul>
 <li>The IP address of the user can legally change from one request to another, e.g. if the user enters or
 leaves a VPN. On the other hand attackers can easily fake IP addresses so relying on IP address often
 reduces user comfort without gaining a very much higher level of <a href="../../../../../../net/sf/mmm/util/lang/api/concern/Security.html" title="interface in net.sf.mmm.util.lang.api.concern"><code>Security</code></a>.</li>
 <li>Do not use <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Random.html?is-external=true" title="class or interface in java.util"><code>Random</code></a> to generate security tokens as this is too weak.</li>
 </ul></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the initial <a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api"><code>CsrfToken</code></a>. Shall not be <code>null</code>.</dd>
</dl>
</li>
</ul>
<a name="generateNewToken--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateNewToken</h4>
<pre>private&nbsp;<a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api">CsrfToken</a>&nbsp;generateNewToken()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a newly generated <a href="../../../../../../net/sf/mmm/service/api/CsrfToken.html" title="interface in net.sf.mmm.service.api"><code>CsrfToken</code></a>.</dd>
</dl>
</li>
</ul>
<a name="getSession--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getSession</h4>
<pre>protected&nbsp;javax.servlet.http.HttpSession&nbsp;getSession()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the <code>HttpSession</code> or <code>null</code> if no request context is available.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CsrfTokenManagerDefaultImpl.html">Use</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../../net/sf/mmm/service/impl/server/RemoteInvocationSecurityDetectorImpl.html" title="class in net.sf.mmm.service.impl.server"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?net/sf/mmm/service/impl/server/CsrfTokenManagerDefaultImpl.html" target="_top">Frames</a></li>
<li><a href="CsrfTokenManagerDefaultImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2001&#x2013;2016 <a href="http://m-m-m.sourceforge.net/team-list.html">mmm-Team</a>. All rights reserved.</small></p>
</body>
</html>
